# 3. 인터럽트의 원리

## 프로그램의 구조와 인터럽트
- 프로그램이 CPU에서 명령을 수행하려면 수행하려는 주소 영역이 메모리에 올라가 있어야 한다.
- 우리가 작성한 프로그램은 처음에 메인 함수에서 실행하여 다른 함수를 호출하면 CPU가 메인 함수의 코드를 수행하다가 다른 함수의 코드로 수행 위치를 이동하게 된다.
- 그러면 프로그램은 새로운 함수 위치로 점프해 그 함수를 실행하고 함수 수행이 완료 된 후에는 원래 호출했던 함수 위치로 돌아온다.
- 이때 다시 돌아와야 하는 지점을 스택에 저정한다.
- 인터럽트의 동작 원리도 이와 비슷하다.
- 프로그램 A가 CPU를 할당받고 명령을 수행하고 있는데 인터럽트가 발생하면 A는 현재 수행중인 명령의 위치를 저장한다.
- 그 후 운영체제 내부 코드인 인터럽트 처리 루틴으로 넘어가서 인터럽트를 처리하고 다시 돌아와 A의 이전 작업 지점부터 수행을 다시 이어간다.
- 인터럽트 때문에 CPU를 선점당한 위치를 저장하기 위해 커널에 저장한다.
- 운영체제는 현재 실행중인 모든 프로그램을 관리하기 위한 자료구조( PCB : Process Control Block )를 유지한다.
- PCB에는 인터럽트가 발생했을 때 그 프로그램이 어디까지 수행했는지를 저장하기 위한 영역이 존재한다.
  1. 프로그램 A가 수행중에 인터럽트가 발생
  2. 현재 지점을 PCB에 저장
  3. 인터럽트 처리 루틴으로 가서 일을 처리
  4. 끝나면 프로그램 A의 PCB에 저장된 주소를 복원 후 원래 하던 일을 재개.   



출처 : 운영 체제와 정보기술의 원리 - 반효경